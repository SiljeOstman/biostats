---
output:
  html_document:
    css: custom.css
--- 

```{r setup&variables, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.align='center')

# title: Creating a (multiple) boxplot
# author: jonathan
# revised: 19/2/2020 

WEB <- c("https://bioceed.uib.no/dropfolder/bioSTATS/Rmd/Basic/Visualizing/Simple/boxplot.html")
GIT <- c("https://github.com/jonathansoule/biostats/blob/master/Basic/Visualizing/Simple/boxplot.Rmd")
library(ggplot2)
```
Boxplots are useful plots to help visualize the median and spread of separate samples at once. Boxplots have a lot in common with [violin plots](https://biostats.w.uib.no/creating-a-violin-plot/){target="_blank"} as they represent the distribution of the samples. The difference is that the box displays the quartiles instead of the probability density.

We will see how to use `ggplot()` to code for a box plot representing 4 groups of 150 data points each. This example is based on the same data set used to illustrate how to draw [violin plots](https://biostats.w.uib.no/creating-a-violin-plot/){target="_blank"} and [jitter plots](https://biostats.w.uib.no/creating-a-jitter-plot/){target="_blank"}, among others. Here are the variables and dataframe:
```{r dataframe}
# variable 1
response <- c(rnorm(150, mean=20, sd=5), rnorm(150, mean=30, sd=4), rnorm(150, mean=15, 3), rnorm(150, mean=40, sd=5)) 
# variable 2
group <- c(rep("Gr1", 150), rep("Gr2", 150), rep("Gr3", 150), rep("Gr4", 150))
# dataframe
df <- data.frame(group, response)
```
<br/><br/>
We first map the data with `aes(group, response)` and we use `geom_boxplot()` to draw the plot. The code is as follows:
```{r plot}
ggplot(df, aes(group, response)) +     
  geom_boxplot() 
```

Note that potential outliers appear in the figure in the form of additional dots abobe and below the whiskers. You may hide them using the argument `outlier.shape = NA`:
```{r no outlier}
ggplot(df, aes(group, response)) +     
  geom_boxplot(outlier.shape = NA) 
```
<br/><br/>
You may alternatively highlight these outliers by changing their colors, shape and size with `outlier.color=`, `outlier.fill=`, `outlier.shape=` and `outlier.size=`:
```{r highlighted outlier}
ggplot(df, aes(group, response)) +     
  geom_boxplot(outlier.color= "darkblue" , outlier.fill= "yellow", outlier.size= 3, outlier.shape = 23) 
```


The colors of the boxes are tunable with `color=` and `fill=`:
```{r tune}
ggplot(df, aes(group, response)) + 
  geom_boxplot(color= "darkblue", fill="lightblue")        
```
<br/><br/>

Finally, you can play with the width of the boxes via the argument `width=`:
```{r width}
ggplot(df, aes(group, response)) + 
  geom_boxplot(width=0.2)
```
  
<br/><br/>


***
<!-- UNCOMMENT TO ACTIVATE
Get the Rmarkdown file corresponding to this page on [GitHub](`r GIT`){target="_blank"}.
-->

